---
authorization_policies:
- modules/dashboard/allow_2fa_verification
- modules/dashboard/is_2FA_activated
layout: modules/dashboard/system_pages
metadata:
  status: published
  page_name: Verify 2FA
  meta_title: Verify 2FA
  page_title: Verify 2FA | Insites
  canonical_url: ''
  sitemap_order: '0'
  open_graph:url: "{{ context.exports.global.company_url | strip }}"
  open_graph:type: ''
  sitemap_enabled: false
  meta_description: Verify 2FA
  open_graph:image: ''
  open_graph:title: Verify 2FA
  sitemap_priority: '1.0'
  sitemap_changefreq: never
  open_graph:site_name: "{{ context.exports.global.company_name | strip }}"
  open_graph:description: Verify 2FA
  is_visible_to_search_engines: false
slug: verify-2fa
---
{% assign hashed = 16 | random_string | compute_hmac: "nonce", "MD4" %}
{%- content_for 'page_nonce' -%}{{ context.instance.uuid | base64_encode |  append: hashed }}{%- endcontent_for -%}
{%- capture page_nonce -%}{%- yield 'page_nonce' -%}{%- endcapture -%}
{% include "modules/insites_core/sessions/delete_session_variables" %}
<div class="verify-2fa-wrapper">


<div class="spacer section"></div>

<form action="{% if context.flash.alert == "Your 2FA has already been setup." %}/account/2fa{% else %}/account/2fa?return_to={{ context.params.return_to |  url_encode }}{% endif %}" method="post">
    {% render 'modules/insites_core/authenticity_token', context: context %}
    <div class="setup-2fa-container verification">
        <div class="grid-x">
            <div class="large-12 cell text-center">
                <div class="qr-code-details-wrapper">
                    <h1>
                        Verification Code
                    </h1>
                    <p class="paragraph-small">
                        Enter Verification Code generated by your authentication app.
                    </p>

                    <div class="spacer small"></div>

                    <div class="otp-input-wrapper">
                        <input name="2fa[otp_code]" type="hidden">
                        <input name="from_page" type="hidden" value="{{ context.params.slug }}">


                        <div class="otp_input_fields">
                            {% for i in (0..5) %}
                                <input inputmode="numeric" pattern="[0-9]*" type="text" maxlength="1" class="otp_input" autocomplete="off" required disabled/>
                            {% endfor %}
                        </div>
                    </div>

                    {% if context.params.status %}
                        <div class="spacer x-small"></div>
                        <p class="paragraph-small is-invalid-label">
                            Invalid code please try again.
                        </p>
                    {% endif %}
                    <ins-button type="submit" class="hide fa-btn" label="Submit" id="submit_button" solid color="blue" size="large"></ins-button>
                </div>
            </div>
        </div>
    </div>
</form>


<div class="spacer section"></div>
</div>
{%- if context.environment == "staging" -%}
    <script nonce="{{ page_nonce }}" src="{{ 'modules/dashboard/scripts/2fa/otp.js' | asset_url }}"></script>
{% else %}
    <script nonce="{{ page_nonce }}" src="{{ 'modules/dashboard/scripts/2fa/otp.min.js' | asset_url }}"></script>
{%- endif -%}