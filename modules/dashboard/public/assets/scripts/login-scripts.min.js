let emailInputInfo={status:"clean",id:null};const mobileFields={inputTel:document.getElementById("mobile-phone"),phone_number:document.getElementById("mobile_phone_number"),country_code:document.getElementById("mobile_phone_country_code")},companyMobileFields={inputTel:document.getElementById("company-mobile-phone"),phone_number:document.getElementById("company_mobile_phone_number"),country_code:document.getElementById("company_mobile_phone_country_code")};let LoginScript={methods:{validateTelField(){let isTel=/^[+]*[(]{0,1}[0-9]{1,4}[)]{0,1}[-\s\./0-9]*$/g,telFields;document.querySelectorAll("[field='tel']").forEach(field=>{field.required?field.value&&!0===isTel.test(field.value)?field.hasError=!1:field.hasError=!0:""===field.value.trim()?field.hasError=!1:field.hasError=1==!isTel.test(field.value)})},validatePasswordField(field){field.value?field.value.length>=6?field.hasError=!1:(field.hasError=!0,field.errorMessage="Minimum of 6 characters"):(field.hasError=!0,field.errorMessage="Password is required")},validatePasswordConfirm(field){let passFields=document.getElementById("password");passFields&&(passFields.value===field.value?field.hasError=!1:(field.hasError=!0,field.errorMessage="Password doesn't match"))},async validationForm(containerEl){for(let index=0;index<containerEl.querySelectorAll("[validate]").length;index++){let field=containerEl.querySelectorAll("[validate]")[index],type;switch(field.tagName.toLowerCase()){case"div":App.validation.validateRadio(field);break;case"ins-input-file":App.validation.validateFile(field);break;case"ins-textarea":App.validation.validateInput(field.querySelector("textarea"));break;case"ins-input":default:"password"===field.field?"password_confirmation"===field.id?this.validatePasswordConfirm(field):this.validatePasswordField(field):"email"===field.field?App.validation.validateEmail(field):App.validation.validateInput(field)}}return App.validation.checkInvalidFields(containerEl)},async validateForm(event,groupElem){event&&event.preventDefault();let formId=event.target.id,formElem=document.getElementById(formId).closest("form");if("submit-personal-details"==formId||"submit-company-details"==formId){if(this.validateTelField(),await this.validationForm(groupElem))switch(emailInputInfo.status){case"clean":return!0;case"update":return this.changeFormToAppend(formElem,emailInputInfo.id),!0;case"error":{let emailElem=document.getElementById("email");emailElem.hasError=!0,emailElem.errorMessage="Email has already been used."}}}else"password-reset-form"==formId?await this.validationForm(formElem)&&formElem.submit():await App.validation.validateForm(formElem)&&formElem.submit()},async checkSignUpUserEmail(event){let emailInput=document.getElementById("email"),varEmail=document.getElementById("email").value;if(App.validation.validateEmail(emailInput)){let url="/check-user-email-signup?email="+varEmail,response=await apiServices.processRequest("get",url);response.state&&response.data&&LoginScript.methods.checkUserEmail(emailInput,response.data)}},checkUserEmail(emailElem,data){"invalid"==data.email_status?(emailElem.hasError=!0,emailElem.errorMessage=data.message,this.updateEmailInputInfo("error")):"no-profile"==data.email_status?(emailElem.hasError=!1,this.updateEmailInputInfo("update",data.email_id)):(emailElem.hasError=!1,this.updateEmailInputInfo("clean"))},changeFormToAppend(formElement,id){let tmpInput=document.createElement("input"),tmpSrc;tmpInput.name="_method",tmpInput.type="hidden",tmpInput.value="patch",formElement.appendChild(tmpInput),formElement.querySelector('input[name="resource_id"]').value=id,formElement.action="/api/users/"+id},updateEmailInputInfo(status,id=null){emailInputInfo.status=status,emailInputInfo.id=id}},init:{initSignUp(){let elem;if(document.getElementById("register-form")){let emailInput;document.getElementById("email").addEventListener("insBlur",LoginScript.methods.checkSignUpUserEmail)}}}};setTimeout(()=>{LoginScript.init.initSignUp()},200);