const input=document.querySelectorAll(".otp_input"),inputField=document.querySelector(".otp_input_fields"),otpInput=document.querySelector("input[name='2fa[otp_code]']"),submitButton=document.getElementById("submit_button");console.log(submitButton);const setupCode=document.getElementById("setup_code"),copyButton=document.querySelector(".copy-btn");let inputCount=0,finalInput="";const updateInputConfig=(element,disabledStatus)=>{element.disabled=disabledStatus,disabledStatus?element.blur():element.focus()};input.forEach(element=>{const optInputs=[...inputField.children],len=optInputs.length;element.addEventListener("keyup",e=>{if("Backspace"==e.key){if(finalInput=finalInput.substring(0,finalInput.length-1),0==inputCount)return!1;inputCount-=1}else inputCount<=5&&"Backspace"!=e.key&&(finalInput+=e.key),inputCount+=1;submitButton.classList.add("hide")}),element.addEventListener("input",ev=>{const elInp=ev.currentTarget,i=optInputs.indexOf(elInp);elInp.value&&(i+1)%len&&(optInputs[i+1].disabled=!1,optInputs[i+1].focus())}),element.addEventListener("paste",ev=>{const clip=ev.clipboardData.getData("text"),pin=clip.replace(/\s/g,""),ch=[...pin];optInputs.forEach((el,i)=>el.value=ch[i]||""),pin.length<=6?(optInputs[pin.length-1].disabled=!1,optInputs[pin.length-1].focus(),inputCount+=pin.length-1):(optInputs[5].disabled=!1,optInputs[5].focus(),inputCount=6)}),element.addEventListener("keydown",ev=>{const elInp=ev.currentTarget,i=optInputs.indexOf(elInp);!elInp.value&&"Backspace"===ev.key&&i&&(optInputs[i].disabled=!0,optInputs[i-1].disabled=!1,optInputs[i-1].focus())})}),window.addEventListener("keyup",e=>{inputCount>5&&(submitButton.classList.remove("hide"),"Backspace"==e.key&&(finalInput=finalInput.substring(0,finalInput.length-1),inputField.lastElementChild.value="",inputCount-=1,submitButton.classList.add("hide")),otpInput.value=finalInput)});const copyToClipboardHandler=()=>{const text=setupCode.innerHTML;if(navigator.clipboard)navigator.clipboard.writeText(text);else if(window.clipboardData&&window.clipboardData.setData)window.clipboardData.setData("Text",text),Promise.resolve();else{const input=document.createElement("input",{type:"text"});input.setAttribute("type","text"),input.value=text,document.body.append(input),input.focus(),input.select(),document.execCommand("copy"),input.remove(),Promise.resolve()}copyButton.classList.add("active"),setTimeout(()=>{copyButton.classList.remove("active")},1200)},manualCodeWrap=document.querySelector(".manual-code-wrap"),startInput=()=>{inputCount=0,finalInput="",input.forEach((function(element,i){element.value="",0==i&&(input[i].disabled=!1,input[i].focus())})),manualCodeWrap&&manualCodeWrap.addEventListener("click",copyToClipboardHandler),submitButton&&submitButton.addEventListener("insClick",event=>{submitButton.loading=!0})};window.onload=startInput();